image:
- Visual Studio 2015

environment:
  matrix:
    - generator: "Visual Studio 14 2015" 
    - arch: Win64 

configuration:
- Release

platform:
- x64

matrix:
  fast_finish: true
  
cache:
  - C:\ProgramData\chocolatey -> appveyor_cache.txt
  
init:
- cmd: cmake --version
- cmd: msbuild /version
- echo %arch%
- echo %APPVEYOR_BUILD_WORKER_IMAGE%
- if "%APPVEYOR_BUILD_WORKER_IMAGE%"=="Visual Studio 2017" ( set generator="Visual Studio 15 2017%arch%" )
- if "%APPVEYOR_BUILD_WORKER_IMAGE%"=="Visual Studio 2015" ( set generator="Visual Studio 14 2015%arch%" )
- if "%APPVEYOR_BUILD_WORKER_IMAGE%"=="Visual Studio 2013" ( set generator="Visual Studio 12 2013%arch%" )
- echo %generator%

before_build:
- cmd: dir %APPVEYOR_BUILD_FOLDER%
- cmd: |-
    mkdir build
    cd build
    cmake --version
    cmake .. -G %generator%
build:
- cmd: dir %APPVEYOR_BUILD_FOLDER%
  project: c:\projects\sample_appveyor\build\template.sln
  parallel: true
 
before_test:
- cmd: dir %APPVEYOR_BUILD_FOLDER%
